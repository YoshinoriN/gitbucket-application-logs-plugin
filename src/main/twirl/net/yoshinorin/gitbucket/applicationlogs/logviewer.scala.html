@(isEnable: Boolean,
  logFile: net.yoshinorin.gitbucket.applicationlogs.models.LogFile,
  defaultDisplayLines: Int,
  displayLimitLines: Int,
  log: Either[net.yoshinorin.gitbucket.applicationlogs.utils.Error, List[String]],
  lineNums: Int,
  curretSortType: net.yoshinorin.gitbucket.applicationlogs.utils.SortTypes
)(implicit context: gitbucket.core.controller.Context)

@import context._
@import net.yoshinorin.gitbucket.applicationlogs.utils.{Error, SortTypes}

@gitbucket.core.html.main("Application Logs") {
  @gitbucket.core.admin.html.menu("applicationlogs") {
    @net.yoshinorin.gitbucket.applicationlogs.html.status(isEnable)
    @net.yoshinorin.gitbucket.applicationlogs.html.navigation(isEnable)
    @log match {
      case Left(e) => { @e.message }
      case Right(v) => {
        <div class="head" style="height: 24px; margin-bottom: 15px;">
          <a href="@context.path/admin/application-logs/list">Logs</a> / #@logFile.id
          <form action="@context.path/admin/application-logs/@logFile.id/view" method="get" class="form-inline pull-right" style="font-size: small">
            <div class="form-group">
              <select class="form-control small" name="sortBy">
                @curretSortType match {
                  case SortTypes.ASC => {
                    <option value="@SortTypes.ASC.value" selected="selected">@SortTypes.ASC.value</option>
                    <option value="@SortTypes.DESC.value">@SortTypes.DESC.value</option>
                  }
                  case SortTypes.DESC => {
                    <option value="@SortTypes.ASC.value">@SortTypes.ASC.value</option>
                    <option value="@SortTypes.DESC.value" selected="selected">@SortTypes.DESC.value</option>
                  }
                }
              </select>
            </div>
            <div class="form-group">
              <input type="text" value="@lineNums" name="lines" class="form-control input-sm" style="max-width: 60px;" placeholder="@lineNums"/> lines from last.
            </div>
            <button type="submit button" class="btn btn-success">Reload</button>
          </form>
        </div>
        <div class="box-header">
          <span class="glyphicon glyphicon-file">
            <span class="label label-default ">@logFile.path</span>
          </span>
        </div>
        <div class="box-content-bottom">
          <!--HACK: max-height calculation is temporary. -->
          <pre class="prettyprint linenums blob" style="max-height: calc(100vh - 250px); overflow-y: scroll;">
            @for(x <- v) { @x
            }
          </pre>
        </div>
      }
    }
  }
}